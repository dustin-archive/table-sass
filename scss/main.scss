//
// + Variables
// =============================================================================

$table-padding: 1 !default;
$table-separator: '|' !default;

//
// + Widths
// =============================================================================

@function table-widths($table) {
  $result: ();

  @each $row in $table {
    @for $i from 1 through length($row) {
      $cell: nth($row, $i);
      $result: join($result, 0);

      @if not nth($result, $i) or str-length($cell) > nth($result, $i) {
        $result: set-nth($result, $i, str-length($cell));
      }
    }
  }

  @return $result;
}

//
// + String repeat
// =============================================================================

@function table-str-repeat($string, $count) {
  $result: '';

  @if $count < 1 {
    @return $result;
  }

  @for $i from 1 through $count {
    $result: $result + $string;
  }

  @return $result;
}

//
// + table
// =============================================================================

@function table($table) {
  $result: '\a';
  $widths: table-widths($table);
  $padding: table-str-repeat(' ', $table-padding);

  @each $row in $table {
    $result: $result + $table-separator;

    @for $i from 1 through length($row) {
      $cell: nth($row, $i);
      $spaces: table-str-repeat(' ', nth($widths, $i) - str-length($cell));
      $result: $result + $padding + $cell + $spaces + $padding + $table-separator;
    }

    $result: $result + '\a';
  }

  @return $result;
}
